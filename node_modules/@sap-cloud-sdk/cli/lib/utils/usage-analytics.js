"use strict";
/*!
 * Copyright (c) 2020 SAP SE or an SAP affiliate company. All rights reserved.
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.usageAnalytics = void 0;
const cli_ux_1 = require("cli-ux");
const fs = require("fs");
const path = require("path");
async function usageAnalytics(projectDir, agreeToAnalytics, salt) {
    const analyticsFilePath = path.resolve(projectDir, 'sap-cloud-sdk-analytics.json');
    if (agreeToAnalytics === false) {
        return fs.writeFileSync(analyticsFilePath, JSON.stringify({ enabled: false }));
    }
    if (agreeToAnalytics || (await cli_ux_1.default.confirm('Do you want to provide anonymous usage analytics to help us improve the SDK? (y|n)'))) {
        const jsonContent = salt ? { enabled: true, salt } : { enabled: true };
        fs.writeFileSync(analyticsFilePath, JSON.stringify(jsonContent));
    }
    else {
        fs.writeFileSync(analyticsFilePath, JSON.stringify({ enabled: false }));
    }
}
exports.usageAnalytics = usageAnalytics;
